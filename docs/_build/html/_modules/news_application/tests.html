

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>news_application.tests &mdash; Capstone Project 00.00.01 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=d7bb8d4d"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Capstone Project
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">news_addiction</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Capstone Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">news_application.tests</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for news_application.tests</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">timedelta</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">io</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">timezone</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.test</span><span class="w"> </span><span class="kn">import</span> <span class="n">TestCase</span><span class="p">,</span> <span class="n">Client</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.models</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span><span class="n">Publisher</span><span class="p">,</span> <span class="n">Article</span><span class="p">,</span> <span class="n">ResetToken</span><span class="p">,</span> <span class="n">User</span><span class="p">,</span> <span class="n">Roles</span><span class="p">,</span> 
                     <span class="n">ReaderProfile</span><span class="p">,</span> <span class="n">JournalistProfile</span><span class="p">,</span> <span class="n">EditorProfile</span><span class="p">,</span>
                     <span class="n">ArticleCategory</span><span class="p">,</span> <span class="n">ArticleStatus</span><span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">date</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.contenttypes.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">ContentType</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.urls</span><span class="w"> </span><span class="kn">import</span> <span class="n">reverse</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.contrib.auth.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">Group</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">django.core.files.uploadedfile</span><span class="w"> </span><span class="kn">import</span> <span class="n">SimpleUploadedFile</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PIL</span><span class="w"> </span><span class="kn">import</span> <span class="n">Image</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">.views</span><span class="w"> </span><span class="kn">import</span> <span class="n">generate_reset_url</span><span class="p">,</span> <span class="n">build_email_reset_password</span>

<span class="c1"># Create your tests here.</span>


<div class="viewcode-block" id="UserFactory">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.UserFactory">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">UserFactory</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Factory class to create test users easily&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="UserFactory.create_reader">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.UserFactory.create_reader">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_reader</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;reader&quot;</span><span class="p">,</span> <span class="n">email</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">email</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">email</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">@test.com&quot;</span>

        <span class="k">if</span> <span class="n">password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">password</span> <span class="o">=</span> <span class="s2">&quot;testpass123&quot;</span>

        <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="n">email</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
            <span class="n">display_name</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;display_name&quot;</span><span class="p">,</span> <span class="s2">&quot;Test Display Name&quot;</span><span class="p">),</span>
            <span class="n">phone_number</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;phone_number&quot;</span><span class="p">,</span> <span class="s2">&quot;+27725643208&quot;</span><span class="p">),</span>
            <span class="n">date_of_birth</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;date_of_birth&quot;</span><span class="p">,</span> <span class="n">date</span><span class="p">(</span><span class="mi">1980</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
            <span class="n">role</span><span class="o">=</span><span class="n">Roles</span><span class="o">.</span><span class="n">READER</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">user</span></div>


<div class="viewcode-block" id="UserFactory.create_journalist">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.UserFactory.create_journalist">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_journalist</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;journalist&quot;</span><span class="p">,</span> <span class="n">email</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">biography</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">email</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">email</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">@test.com&quot;</span>

        <span class="k">if</span> <span class="n">password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">password</span> <span class="o">=</span> <span class="s2">&quot;testpass123&quot;</span>

        <span class="k">if</span> <span class="n">biography</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">biography</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Biography for </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&quot;</span>
            
        <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="n">email</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
            <span class="n">display_name</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;display_name&quot;</span><span class="p">,</span> <span class="s2">&quot;Test Display Name&quot;</span><span class="p">),</span>
            <span class="n">phone_number</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;phone_number&quot;</span><span class="p">,</span> <span class="s2">&quot;+27725643209&quot;</span><span class="p">),</span>
            <span class="n">date_of_birth</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;date_of_birth&quot;</span><span class="p">,</span> <span class="n">date</span><span class="p">(</span><span class="mi">1975</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
            <span class="n">role</span><span class="o">=</span><span class="n">Roles</span><span class="o">.</span><span class="n">JOURNALIST</span>
        <span class="p">)</span>
        <span class="n">user</span><span class="o">.</span><span class="n">journalist_profile</span><span class="o">.</span><span class="n">biography</span> <span class="o">=</span> <span class="n">biography</span>
        <span class="k">return</span> <span class="n">user</span></div>

    
<div class="viewcode-block" id="UserFactory.create_editor">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.UserFactory.create_editor">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_editor</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;editor&quot;</span><span class="p">,</span> <span class="n">email</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">email</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">email</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">@test.com&quot;</span>

        <span class="k">if</span> <span class="n">password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">password</span> <span class="o">=</span> <span class="s2">&quot;testpass123&quot;</span>
            
        <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create_user</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="n">email</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
            <span class="n">display_name</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;display_name&quot;</span><span class="p">,</span> <span class="s2">&quot;Test Display Name&quot;</span><span class="p">),</span>
            <span class="n">phone_number</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;phone_number&quot;</span><span class="p">,</span> <span class="s2">&quot;+27555666777&quot;</span><span class="p">),</span>
            <span class="n">date_of_birth</span><span class="o">=</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;date_of_birth&quot;</span><span class="p">,</span> <span class="n">date</span><span class="p">(</span><span class="mi">1960</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
            <span class="n">role</span><span class="o">=</span><span class="n">Roles</span><span class="o">.</span><span class="n">EDITOR</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">user</span></div>
</div>

    
<div class="viewcode-block" id="PublisherFactory">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.PublisherFactory">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">PublisherFactory</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Factory class to create test publishers easily&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="PublisherFactory.create_publisher">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.PublisherFactory.create_publisher">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_publisher</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Test Publisher&quot;</span><span class="p">,</span> 
                         <span class="n">description</span><span class="o">=</span><span class="s2">&quot;A Test publisher&quot;</span><span class="p">,</span>
                         <span class="n">website</span><span class="o">=</span><span class="s2">&quot;https://www.testpublisher.com&quot;</span><span class="p">,</span>
                         <span class="n">email</span><span class="o">=</span><span class="s2">&quot;test@publisher.com&quot;</span><span class="p">):</span>
        
        <span class="c1"># Create a simple mock image file for testing</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">temp_file</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
        <span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">temp_file</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;JPEG&#39;</span><span class="p">)</span>
        <span class="n">temp_file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="n">logo_file</span> <span class="o">=</span> <span class="n">SimpleUploadedFile</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;test_logo.jpg&#39;</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="n">temp_file</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
            <span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;image/jpeg&#39;</span>
        <span class="p">)</span>
        
        <span class="k">return</span> <span class="n">Publisher</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
            <span class="n">website</span><span class="o">=</span><span class="n">website</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="n">email</span><span class="p">,</span>
            <span class="n">logo</span><span class="o">=</span><span class="n">logo_file</span>
        <span class="p">)</span></div>
</div>


    
<div class="viewcode-block" id="ArticleFactory">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.ArticleFactory">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">ArticleFactory</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Factory class to create test articles easily&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="ArticleFactory.create_article">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.ArticleFactory.create_article">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_article</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Article&quot;</span><span class="p">,</span>
                       <span class="n">content</span><span class="o">=</span><span class="s2">&quot;Test Content&quot;</span><span class="p">,</span>
                       <span class="n">author</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">publisher</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">category</span><span class="o">=</span><span class="n">ArticleCategory</span><span class="o">.</span><span class="n">SPORTS</span><span class="p">,</span>
                      <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">author</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">author</span> <span class="o">=</span> <span class="n">UserFactory</span><span class="o">.</span><span class="n">create_journalist</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">publisher</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">publisher</span> <span class="o">=</span> <span class="n">PublisherFactory</span><span class="o">.</span><span class="n">create_publisher</span><span class="p">()</span>
        
        <span class="c1"># Create a simple mock image file for testing</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">temp_file</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
        <span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">temp_file</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;JPEG&#39;</span><span class="p">)</span>
        <span class="n">temp_file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="n">logo_file</span> <span class="o">=</span> <span class="n">SimpleUploadedFile</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;test_logo.jpg&#39;</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="n">temp_file</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
            <span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;image/jpeg&#39;</span>
        <span class="p">)</span>


        <span class="k">return</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span>
            <span class="n">author</span><span class="o">=</span><span class="n">author</span><span class="p">,</span>
            <span class="n">publisher</span><span class="o">=</span><span class="n">publisher</span><span class="p">,</span>
            <span class="n">category</span><span class="o">=</span><span class="n">category</span><span class="p">,</span>
            <span class="n">image</span><span class="o">=</span><span class="n">logo_file</span><span class="p">,</span>
        <span class="p">)</span></div>
</div>


<div class="viewcode-block" id="TestUserModels">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestUserModels">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TestUserModels</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test user model creation and relationships&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="TestUserModels.test_create_reader">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestUserModels.test_create_reader">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_create_reader</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test creating a reader user with profile&quot;&quot;&quot;</span>
        <span class="n">read_user</span> <span class="o">=</span> <span class="n">UserFactory</span><span class="o">.</span><span class="n">create_reader</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_reader&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">read_user</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="s2">&quot;test_reader&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">read_user</span><span class="o">.</span><span class="n">is_reader</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">read_user</span><span class="o">.</span><span class="n">is_journalist</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">read_user</span><span class="o">.</span><span class="n">is_editor</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">read_user</span><span class="o">.</span><span class="n">role</span><span class="p">,</span> <span class="n">Roles</span><span class="o">.</span><span class="n">READER</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="TestUserModels.test_create_journalist">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestUserModels.test_create_journalist">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_create_journalist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test creating a journalist user with profile&quot;&quot;&quot;</span>
        <span class="n">journal_user</span> <span class="o">=</span> <span class="n">UserFactory</span><span class="o">.</span><span class="n">create_journalist</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_journalist&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">journal_user</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="s2">&quot;test_journalist&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">journal_user</span><span class="o">.</span><span class="n">is_journalist</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">journal_user</span><span class="o">.</span><span class="n">is_reader</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">journal_user</span><span class="o">.</span><span class="n">is_editor</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">journal_user</span><span class="o">.</span><span class="n">journalist_profile</span><span class="o">.</span><span class="n">biography</span><span class="p">,</span> 
                         <span class="sa">f</span><span class="s2">&quot;Biography for </span><span class="si">{</span><span class="n">journal_user</span><span class="o">.</span><span class="n">username</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">journal_user</span><span class="o">.</span><span class="n">role</span><span class="p">,</span> <span class="n">Roles</span><span class="o">.</span><span class="n">JOURNALIST</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="TestUserModels.test_create_editor">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestUserModels.test_create_editor">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_create_editor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test creating an editor user with profile&quot;&quot;&quot;</span>
        <span class="n">editor_user</span> <span class="o">=</span> <span class="n">UserFactory</span><span class="o">.</span><span class="n">create_editor</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_editor&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">editor_user</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="s2">&quot;test_editor&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">editor_user</span><span class="o">.</span><span class="n">is_editor</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">editor_user</span><span class="o">.</span><span class="n">is_reader</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">editor_user</span><span class="o">.</span><span class="n">is_journalist</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">editor_user</span><span class="o">.</span><span class="n">role</span><span class="p">,</span> <span class="n">Roles</span><span class="o">.</span><span class="n">EDITOR</span><span class="p">)</span></div>
</div>



    
<div class="viewcode-block" id="TestPublisherModel">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestPublisherModel">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TestPublisherModel</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test publisher model creation and relationships&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="TestPublisherModel.test_create_publisher">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestPublisherModel.test_create_publisher">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_create_publisher</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test creating a publisher&quot;&quot;&quot;</span>
        <span class="n">publisher</span> <span class="o">=</span> <span class="n">PublisherFactory</span><span class="o">.</span><span class="n">create_publisher</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;My Publisher&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">publisher</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;My Publisher&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">publisher</span><span class="o">.</span><span class="n">description</span><span class="p">,</span> <span class="s2">&quot;A Test publisher&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">publisher</span><span class="o">.</span><span class="n">website</span><span class="p">,</span> <span class="s2">&quot;https://www.testpublisher.com&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">publisher</span><span class="o">.</span><span class="n">email</span><span class="p">,</span> <span class="s2">&quot;test@publisher.com&quot;</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="TestArticleModel">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestArticleModel">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TestArticleModel</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test article model creation and relationships&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="TestArticleModel.test_create_article">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestArticleModel.test_create_article">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_create_article</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test creating an article&quot;&quot;&quot;</span>
        <span class="n">author</span> <span class="o">=</span> <span class="n">UserFactory</span><span class="o">.</span><span class="n">create_journalist</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;article_author&quot;</span><span class="p">)</span>
        <span class="n">publisher</span> <span class="o">=</span> <span class="n">PublisherFactory</span><span class="o">.</span><span class="n">create_publisher</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Article Publisher&quot;</span><span class="p">)</span>
        <span class="n">article</span> <span class="o">=</span> <span class="n">ArticleFactory</span><span class="o">.</span><span class="n">create_article</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;My First Article&quot;</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="s2">&quot;Test Content&quot;</span><span class="p">,</span>
            <span class="n">author</span><span class="o">=</span><span class="n">author</span><span class="p">,</span>
            <span class="n">publisher</span><span class="o">=</span><span class="n">publisher</span><span class="p">,</span>
            <span class="n">category</span><span class="o">=</span><span class="n">ArticleCategory</span><span class="o">.</span><span class="n">SPORTS</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">article</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="s2">&quot;My First Article&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">article</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="s2">&quot;Test Content&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">article</span><span class="o">.</span><span class="n">author</span><span class="p">,</span> <span class="n">author</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">article</span><span class="o">.</span><span class="n">publisher</span><span class="p">,</span> <span class="n">publisher</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">article</span><span class="o">.</span><span class="n">category</span><span class="p">,</span> <span class="n">ArticleCategory</span><span class="o">.</span><span class="n">SPORTS</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNotNone</span><span class="p">(</span><span class="n">article</span><span class="o">.</span><span class="n">created_at</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIsNotNone</span><span class="p">(</span><span class="n">article</span><span class="o">.</span><span class="n">updated_at</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="TestResetTokenModel">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestResetTokenModel">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TestResetTokenModel</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="TestResetTokenModel.setUp">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestResetTokenModel.setUp">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Create a user object:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_user</span> <span class="o">=</span> <span class="n">UserFactory</span><span class="o">.</span><span class="n">create_reader</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_reader&quot;</span><span class="p">)</span>

        <span class="c1"># Create a ResetToken object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_token</span> <span class="o">=</span> <span class="n">ResetToken</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">read_user</span><span class="p">,</span>
            <span class="n">token</span><span class="o">=</span><span class="s2">&quot;test_token&quot;</span><span class="p">,</span>
            <span class="n">expiry_date</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
            <span class="n">used</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="TestResetTokenModel.test_reset_token_details">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestResetTokenModel.test_reset_token_details">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_reset_token_details</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">reset_token</span> <span class="o">=</span> <span class="n">ResetToken</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reset_token</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">reset_token</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="s2">&quot;test_reader&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">reset_token</span><span class="o">.</span><span class="n">token</span><span class="p">,</span> <span class="s2">&quot;test_token&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">reset_token</span><span class="o">.</span><span class="n">used</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">reset_token</span><span class="o">.</span><span class="n">expiry_date</span> <span class="o">&gt;</span> <span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">())</span></div>
</div>


<div class="viewcode-block" id="TestResetTokenExpiry">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestResetTokenExpiry">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TestResetTokenExpiry</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="TestResetTokenExpiry.setUp">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestResetTokenExpiry.setUp">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Create a user object:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_user</span> <span class="o">=</span> <span class="n">UserFactory</span><span class="o">.</span><span class="n">create_reader</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_reader&quot;</span><span class="p">)</span>

        <span class="c1"># Create a ResetToken object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_token</span> <span class="o">=</span> <span class="n">ResetToken</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">read_user</span><span class="p">,</span>
            <span class="n">token</span><span class="o">=</span><span class="s2">&quot;test_token&quot;</span><span class="p">,</span>
            <span class="n">expiry_date</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
            <span class="n">used</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span></div>



<div class="viewcode-block" id="TestResetTokenExpiry.test_reset_token_details">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestResetTokenExpiry.test_reset_token_details">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_reset_token_details</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">reset_token</span> <span class="o">=</span> <span class="n">ResetToken</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reset_token</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">reset_token</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="s2">&quot;test_reader&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">reset_token</span><span class="o">.</span><span class="n">token</span><span class="p">,</span> <span class="s2">&quot;test_token&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">reset_token</span><span class="o">.</span><span class="n">used</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">reset_token</span><span class="o">.</span><span class="n">expiry_date</span> <span class="o">&lt;</span> <span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">())</span></div>
</div>



<div class="viewcode-block" id="TestLoginView">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestLoginView">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TestLoginView</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
<div class="viewcode-block" id="TestLoginView.setUp">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestLoginView.setUp">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
        <span class="c1"># Create a user object:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_user</span> <span class="o">=</span> <span class="n">UserFactory</span><span class="o">.</span><span class="n">create_reader</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_reader&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journalist_user</span> <span class="o">=</span> <span class="n">UserFactory</span><span class="o">.</span><span class="n">create_journalist</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_journalist&quot;</span>
            <span class="p">)</span>                                                      
        <span class="bp">self</span><span class="o">.</span><span class="n">editor_user</span> <span class="o">=</span> <span class="n">UserFactory</span><span class="o">.</span><span class="n">create_editor</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_editor&quot;</span><span class="p">)</span></div>



<div class="viewcode-block" id="TestLoginView.test_login_page_get_request">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestLoginView.test_login_page_get_request">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_login_page_get_request</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that login page loads correctly with GET request&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;login_page&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;Login&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;form&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestLoginView.test_successful_reader_login">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestLoginView.test_successful_reader_login">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_successful_reader_login</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test successful login for reader user&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;login_page&#39;</span><span class="p">),</span> <span class="p">{</span>
            <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_user</span><span class="o">.</span><span class="n">username</span><span class="p">,</span>
            <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;testpass123&quot;</span>
        <span class="p">})</span>

        <span class="c1"># Check redirect to reader dashboard</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_start_page&#39;</span><span class="p">))</span>
        
        <span class="c1"># Verify user is logged in and session is set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="s1">&#39;_auth_user_id&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;_auth_user_id&#39;</span><span class="p">]),</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">read_user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">],</span> 
                         <span class="bp">self</span><span class="o">.</span><span class="n">read_user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestLoginView.test_successful_journalist_login">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestLoginView.test_successful_journalist_login">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_successful_journalist_login</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test successful login for journalist user&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;login_page&#39;</span><span class="p">),</span> <span class="p">{</span>
            <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">journalist_user</span><span class="o">.</span><span class="n">username</span><span class="p">,</span>
            <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;testpass123&quot;</span>
        <span class="p">})</span>

        <span class="c1"># Check redirect to journalist dashboard</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;journalist_start_page&#39;</span><span class="p">))</span>
        
        <span class="c1"># Verify user is logged in and session is set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="s1">&#39;_auth_user_id&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;_auth_user_id&#39;</span><span class="p">]),</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">journalist_user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">],</span> 
                         <span class="bp">self</span><span class="o">.</span><span class="n">journalist_user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="TestLoginView.test_successful_editor_login">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestLoginView.test_successful_editor_login">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_successful_editor_login</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test successful login for editor user&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;login_page&#39;</span><span class="p">),</span> <span class="p">{</span>
            <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor_user</span><span class="o">.</span><span class="n">username</span><span class="p">,</span>
            <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;testpass123&quot;</span>
        <span class="p">})</span>

        <span class="c1"># Check redirect to editor dashboard</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;editor_start_page&#39;</span><span class="p">))</span>
        
        <span class="c1"># Verify user is logged in and session is set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="s1">&#39;_auth_user_id&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">session</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;_auth_user_id&#39;</span><span class="p">]),</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">editor_user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">session</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">],</span> 
                         <span class="bp">self</span><span class="o">.</span><span class="n">editor_user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="TestLoginView.test_failed_login_invalid_credentials">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestLoginView.test_failed_login_invalid_credentials">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_failed_login_invalid_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test login with invalid credentials&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;login_page&#39;</span><span class="p">),</span> <span class="p">{</span>
            <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_user</span><span class="o">.</span><span class="n">username</span><span class="p">,</span>
            <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;wrongpassword&quot;</span>
        <span class="p">})</span>
        
        <span class="c1"># Should stay on login page</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;form&#39;</span><span class="p">)</span>
        
        <span class="c1"># User should not be logged in</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="s1">&#39;_auth_user_id&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">session</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestLoginView.test_failed_login_nonexistent_user">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestLoginView.test_failed_login_nonexistent_user">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_failed_login_nonexistent_user</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test login with non-existent username&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;login_page&#39;</span><span class="p">),</span> <span class="p">{</span>
            <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;nonexistent_user&#39;</span><span class="p">,</span>
            <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="s1">&#39;anypassword&#39;</span>
        <span class="p">})</span>
        
        <span class="c1"># Should stay on login page</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;form&#39;</span><span class="p">)</span>
        
        <span class="c1"># User should not be logged in</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="s1">&#39;_auth_user_id&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">session</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestLoginView.test_session_expiry_on_login">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestLoginView.test_session_expiry_on_login">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_session_expiry_on_login</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that session expires on browser close&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;login_page&#39;</span><span class="p">),</span> <span class="p">{</span>
            <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">editor_user</span><span class="o">.</span><span class="n">username</span><span class="p">,</span>
            <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;testpass123&quot;</span>
        <span class="p">})</span>
        
        <span class="c1"># Follow the redirect to ensure session is fully processed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;editor_start_page&#39;</span><span class="p">))</span>

        <span class="c1"># Now check session expiry after the redirect is complete</span>
        <span class="c1"># The session should be set to expire at browser close</span>
        <span class="n">session</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">session</span>
        
        <span class="c1"># Check if session is set to expire at browser close</span>
        <span class="n">expire_at_browser_close</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get_expire_at_browser_close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span>
            <span class="n">expire_at_browser_close</span><span class="p">,</span>
            <span class="s2">&quot;Session should be set to expire when browser closes&quot;</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="TestLoginView.test_empty_form_submission">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestLoginView.test_empty_form_submission">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_empty_form_submission</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test login with empty form&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;login_page&#39;</span><span class="p">),</span> <span class="p">{})</span>
        
        <span class="c1"># Should stay on login page with form errors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;form&#39;</span><span class="p">)</span>
        
        <span class="c1"># User should not be logged in</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="s1">&#39;_auth_user_id&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">session</span><span class="p">)</span></div>


<div class="viewcode-block" id="TestLoginView.test_login_form_context">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestLoginView.test_login_form_context">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_login_form_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that login form is properly passed to template&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;login_page&#39;</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s1">&#39;form&#39;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s1">&#39;page_title&#39;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;page_title&#39;</span><span class="p">],</span> <span class="s1">&#39;Login&#39;</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="TestPasswordReset">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestPasswordReset">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TestPasswordReset</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test cases for password reset functionality&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="TestPasswordReset.setUp">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestPasswordReset.setUp">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up test user and client&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">UserFactory</span><span class="o">.</span><span class="n">create_reader</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_reader&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span></div>


<div class="viewcode-block" id="TestPasswordReset.test_reset_token_model_creation">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestPasswordReset.test_reset_token_model_creation">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_reset_token_model_creation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test ResetToken model creation and properties&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">hashlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">sha1</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">secrets</span>
        
        <span class="c1"># Create a reset token manually</span>
        <span class="n">token</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">secrets</span><span class="o">.</span><span class="n">token_urlsafe</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
        <span class="n">hashed_token</span> <span class="o">=</span> <span class="n">sha1</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
        <span class="n">expiry_date</span> <span class="o">=</span> <span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        
        <span class="n">reset_token</span> <span class="o">=</span> <span class="n">ResetToken</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
            <span class="n">token</span><span class="o">=</span><span class="n">hashed_token</span><span class="p">,</span>
            <span class="n">expiry_date</span><span class="o">=</span><span class="n">expiry_date</span>
        <span class="p">)</span>
        
        <span class="c1"># Test token properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">reset_token</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">reset_token</span><span class="o">.</span><span class="n">token</span><span class="p">,</span> <span class="n">hashed_token</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">reset_token</span><span class="o">.</span><span class="n">used</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">reset_token</span><span class="o">.</span><span class="n">expiry_date</span><span class="p">,</span> <span class="n">expiry_date</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="TestPasswordReset.test_request_reset_password_view_get">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestPasswordReset.test_request_reset_password_view_get">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_request_reset_password_view_get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test GET request to password reset request page&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;request_reset_password_page&#39;</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;Request Password Reset&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s1">&#39;form&#39;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="TestPasswordReset.test_request_reset_password_valid_user">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestPasswordReset.test_request_reset_password_valid_user">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_request_reset_password_valid_user</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test password reset request with valid user credentials&quot;&quot;&quot;</span>
        <span class="c1"># Ensure no reset tokens exist initially</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ResetToken</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
        
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;request_reset_password_page&#39;</span><span class="p">),</span> <span class="p">{</span>
            <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="p">,</span>
            <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">email</span>
        <span class="p">})</span>
        
        <span class="c1"># Should redirect to login page</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;login_page&#39;</span><span class="p">))</span>
        
        <span class="c1"># A reset token should be created</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ResetToken</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="c1"># Check that token is associated with correct user</span>
        <span class="n">token</span> <span class="o">=</span> <span class="n">ResetToken</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">used</span><span class="p">)</span>
        
        <span class="c1"># Check that expiry date is set to future (5 minutes)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertGreater</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">expiry_date</span><span class="p">,</span> <span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">())</span></div>

        
<div class="viewcode-block" id="TestPasswordReset.test_request_reset_password_invalid_user">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestPasswordReset.test_request_reset_password_invalid_user">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_request_reset_password_invalid_user</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test password reset request with non-existent user&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;request_reset_password_page&#39;</span><span class="p">),</span> <span class="p">{</span>
            <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="s1">&#39;nonexistent&#39;</span><span class="p">,</span>
            <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;nonexistent@example.com&#39;</span>
        <span class="p">})</span>
        
        <span class="c1"># Should redirect to login page</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;login_page&#39;</span><span class="p">))</span>
        
        <span class="c1"># No reset token should be created</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ResetToken</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="TestPasswordReset.test_request_reset_password_mismatched_credentials">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestPasswordReset.test_request_reset_password_mismatched_credentials">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_request_reset_password_mismatched_credentials</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test password reset request with mismatched username and email&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;request_reset_password_page&#39;</span><span class="p">),</span> <span class="p">{</span>
            <span class="s1">&#39;username&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="p">,</span>
            <span class="s1">&#39;email&#39;</span><span class="p">:</span> <span class="s1">&#39;wrong@example.com&#39;</span>
        <span class="p">})</span>
        
        <span class="c1"># Should redirect to login page</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;login_page&#39;</span><span class="p">))</span>
        
        <span class="c1"># No reset token should be created</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ResetToken</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span></div>

        

        
<div class="viewcode-block" id="TestPasswordReset.test_reset_password_with_valid_token">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestPasswordReset.test_reset_password_with_valid_token">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_reset_password_with_valid_token</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test password reset with valid token&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">hashlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">sha1</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">secrets</span>
        
        <span class="c1"># Create a reset token</span>
        <span class="n">token</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">secrets</span><span class="o">.</span><span class="n">token_urlsafe</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
        <span class="n">hashed_token</span> <span class="o">=</span> <span class="n">sha1</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
        <span class="n">expiry_date</span> <span class="o">=</span> <span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        
        <span class="n">reset_token</span> <span class="o">=</span> <span class="n">ResetToken</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
            <span class="n">token</span><span class="o">=</span><span class="n">hashed_token</span><span class="p">,</span>
            <span class="n">expiry_date</span><span class="o">=</span><span class="n">expiry_date</span>
        <span class="p">)</span>
        
        <span class="c1"># GET request to reset password page</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;password_reset&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">token</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;Reset Password&#39;</span><span class="p">)</span>
        
        <span class="c1"># POST request to actually reset password</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;password_reset&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">token</span><span class="p">]),</span> <span class="p">{</span>
            <span class="s1">&#39;new_password1&#39;</span><span class="p">:</span> <span class="s1">&#39;newpassword123&#39;</span><span class="p">,</span>
            <span class="s1">&#39;new_password2&#39;</span><span class="p">:</span> <span class="s1">&#39;newpassword123&#39;</span>
        <span class="p">})</span>
        
        <span class="c1"># Should redirect to login page</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;login_page&#39;</span><span class="p">))</span>
        
        <span class="c1"># Token should be deleted after use</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ResetToken</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>
        
        <span class="c1"># User password should be changed</span>
        <span class="n">updated_user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">updated_user</span><span class="o">.</span><span class="n">check_password</span><span class="p">(</span><span class="s1">&#39;newpassword123&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">updated_user</span><span class="o">.</span><span class="n">check_password</span><span class="p">(</span><span class="s1">&#39;testpass123&#39;</span><span class="p">))</span></div>

        
<div class="viewcode-block" id="TestPasswordReset.test_reset_password_with_expired_token">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestPasswordReset.test_reset_password_with_expired_token">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_reset_password_with_expired_token</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test password reset with expired token&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">hashlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">sha1</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">secrets</span>
        
        <span class="c1"># Create an expired reset token</span>
        <span class="n">token</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">secrets</span><span class="o">.</span><span class="n">token_urlsafe</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
        <span class="n">hashed_token</span> <span class="o">=</span> <span class="n">sha1</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
        <span class="n">expiry_date</span> <span class="o">=</span> <span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Expired</span>
        
        <span class="n">reset_token</span> <span class="o">=</span> <span class="n">ResetToken</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
            <span class="n">token</span><span class="o">=</span><span class="n">hashed_token</span><span class="p">,</span>
            <span class="n">expiry_date</span><span class="o">=</span><span class="n">expiry_date</span>
        <span class="p">)</span>
        
        <span class="c1"># Try to access reset password page with expired token</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;password_reset&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">token</span><span class="p">]))</span>
        
        <span class="c1"># Should redirect to request reset password page</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;request_reset_password_page&#39;</span><span class="p">))</span>
        
        <span class="c1"># Expired token should be deleted</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ResetToken</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="TestPasswordReset.test_reset_password_with_invalid_token">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestPasswordReset.test_reset_password_with_invalid_token">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_reset_password_with_invalid_token</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test password reset with invalid/non-existent token&quot;&quot;&quot;</span>
        <span class="n">fake_token</span> <span class="o">=</span> <span class="s2">&quot;invalid_token_123&quot;</span>
        
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;password_reset&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">fake_token</span><span class="p">]))</span>
        
        <span class="c1"># Should redirect to request reset password page</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;request_reset_password_page&#39;</span><span class="p">))</span></div>

        
<div class="viewcode-block" id="TestPasswordReset.test_reset_password_form_validation">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestPasswordReset.test_reset_password_form_validation">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_reset_password_form_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test password reset form validation&quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">hashlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">sha1</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">secrets</span>
        
        <span class="c1"># Create a valid reset token</span>
        <span class="n">token</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">secrets</span><span class="o">.</span><span class="n">token_urlsafe</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
        <span class="n">hashed_token</span> <span class="o">=</span> <span class="n">sha1</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
        <span class="n">expiry_date</span> <span class="o">=</span> <span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        
        <span class="n">reset_token</span> <span class="o">=</span> <span class="n">ResetToken</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">user</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
            <span class="n">token</span><span class="o">=</span><span class="n">hashed_token</span><span class="p">,</span>
            <span class="n">expiry_date</span><span class="o">=</span><span class="n">expiry_date</span>
        <span class="p">)</span>
        
        <span class="c1"># Test with mismatched passwords</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;password_reset&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">token</span><span class="p">]),</span> <span class="p">{</span>
            <span class="s1">&#39;new_password1&#39;</span><span class="p">:</span> <span class="s1">&#39;newpassword123&#39;</span><span class="p">,</span>
            <span class="s1">&#39;new_password2&#39;</span><span class="p">:</span> <span class="s1">&#39;differentpassword&#39;</span>
        <span class="p">})</span>
        
        <span class="c1"># Should stay on reset password page with error</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;form&#39;</span><span class="p">)</span>
        
        <span class="c1"># Token should still exist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ResetToken</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="c1"># User password should not be changed</span>
        <span class="n">updated_user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">updated_user</span><span class="o">.</span><span class="n">check_password</span><span class="p">(</span><span class="s1">&#39;testpass123&#39;</span><span class="p">))</span></div>

        
<div class="viewcode-block" id="TestPasswordReset.test_generate_reset_url_function">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestPasswordReset.test_generate_reset_url_function">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_generate_reset_url_function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test the generate_reset_url function&quot;&quot;&quot;</span>
        
        
        <span class="c1"># Generate reset URL</span>
        <span class="n">reset_url</span> <span class="o">=</span> <span class="n">generate_reset_url</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
        
        <span class="c1"># Check that URL is properly formatted</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">reset_url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span>
            <span class="s2">&quot;http://127.0.0.1:8000/reset_password/&quot;</span><span class="p">))</span>
        
        <span class="c1"># Check that a reset token was created</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">ResetToken</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="n">token</span> <span class="o">=</span> <span class="n">ResetToken</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">used</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="TestPasswordReset.test_build_email_reset_password_function">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestPasswordReset.test_build_email_reset_password_function">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_build_email_reset_password_function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test the build_email_reset_password function&quot;&quot;&quot;</span>
        
        <span class="n">reset_url</span> <span class="o">=</span> <span class="s2">&quot;http://127.0.0.1:8000/reset_password/test_token&quot;</span>
        <span class="n">email</span> <span class="o">=</span> <span class="n">build_email_reset_password</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">reset_url</span><span class="p">)</span>
        
        <span class="c1"># Check email properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">email</span><span class="o">.</span><span class="n">subject</span><span class="p">,</span> <span class="s2">&quot;Password Reset Requested&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">email</span><span class="o">.</span><span class="n">to</span><span class="p">,</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">email</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="n">email</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="n">reset_url</span><span class="p">,</span> <span class="n">email</span><span class="o">.</span><span class="n">body</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="TestJournalistViews">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestJournalistViews">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TestJournalistViews</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test journalist-specific views and functionality&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="TestJournalistViews.setUp">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestJournalistViews.setUp">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up test data for journalist view tests&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journalist</span> <span class="o">=</span> <span class="n">UserFactory</span><span class="o">.</span><span class="n">create_journalist</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_journalist&quot;</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="s2">&quot;journalist@test.com&quot;</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span> <span class="o">=</span> <span class="n">PublisherFactory</span><span class="o">.</span><span class="n">create_publisher</span><span class="p">()</span>
        
        <span class="c1"># Assign journalist to publisher (required for article creation)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="o">.</span><span class="n">publishers_you_write_for</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="o">.</span><span class="n">save</span><span class="p">()</span></div>

        
<div class="viewcode-block" id="TestJournalistViews.test_journalist_can_add_article_via_view">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestJournalistViews.test_journalist_can_add_article_via_view">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_journalist_can_add_article_via_view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that a journalist can successfully add an article via view&quot;&quot;&quot;</span>
        
        <span class="c1"># Log in as journalist</span>
        <span class="n">login_successful</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_journalist&quot;</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">login_successful</span><span class="p">)</span>
        
        <span class="c1"># Prepare article data</span>
        <span class="n">article_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Test Article Title&#39;</span><span class="p">,</span>
            <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="s1">&#39;This is the content of the test article.&#39;</span><span class="p">,</span>
            <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="n">ArticleCategory</span><span class="o">.</span><span class="n">CURRENT_EVENTS</span><span class="p">,</span>
        <span class="p">}</span>
        
        <span class="c1"># Count articles before submission</span>
        <span class="n">initial_article_count</span> <span class="o">=</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
        
        <span class="c1"># Submit POST request to add article</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;journalist_article_add_page&#39;</span><span class="p">),</span>
            <span class="n">data</span><span class="o">=</span><span class="n">article_data</span><span class="p">,</span>
            <span class="n">follow</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        
        <span class="c1"># Check that article was created</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="n">initial_article_count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="c1"># Get the created article</span>
        <span class="n">created_article</span> <span class="o">=</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">latest</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
        
        <span class="c1"># Verify article properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">created_article</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">article_data</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">created_article</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="n">article_data</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">created_article</span><span class="o">.</span><span class="n">category</span><span class="p">,</span> <span class="n">article_data</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">created_article</span><span class="o">.</span><span class="n">author</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="p">)</span>
        
        <span class="c1"># Check that response redirects to article management page</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span>
            <span class="n">response</span><span class="p">,</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;journalist_article_management_page&#39;</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="c1"># Verify article is in DRAFT status by default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="n">created_article</span><span class="o">.</span><span class="n">publication_status</span><span class="p">,</span>
            <span class="n">ArticleStatus</span><span class="o">.</span><span class="n">DRAFT</span>
        <span class="p">)</span></div>

        
<div class="viewcode-block" id="TestJournalistViews.test_journalist_add_article_view_requires_authentication">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestJournalistViews.test_journalist_add_article_view_requires_authentication">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_journalist_add_article_view_requires_authentication</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that the add article view requires authentication&quot;&quot;&quot;</span>
        
        <span class="c1"># Try to access add article view without logging in</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;journalist_article_add_page&#39;</span><span class="p">))</span>
        
        <span class="c1"># Should redirect to login page</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">302</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="TestJournalistViews.test_journalist_add_article_view_get_request">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestJournalistViews.test_journalist_add_article_view_get_request">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_journalist_add_article_view_get_request</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test GET request to add article view returns form&quot;&quot;&quot;</span>
        
        <span class="c1"># Log in as journalist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_journalist&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># GET request to add article view</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;journalist_article_add_page&#39;</span><span class="p">))</span>
        
        <span class="c1"># Check response</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;form&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;content&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="TestJournalistViews.test_journalist_add_article_with_invalid_data">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestJournalistViews.test_journalist_add_article_with_invalid_data">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_journalist_add_article_with_invalid_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that invalid article data is handled properly&quot;&quot;&quot;</span>
        
        <span class="c1"># Log in as journalist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_journalist&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># Submit empty form data</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;journalist_article_add_page&#39;</span><span class="p">),</span>
            <span class="n">data</span><span class="o">=</span><span class="p">{}</span>
        <span class="p">)</span>
        
        <span class="c1"># Should return form with errors (not redirect)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;form&#39;</span><span class="p">)</span>
        
        <span class="c1"># No article should be created</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="TestEditorViews">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestEditorViews">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TestEditorViews</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test editor-specific views and functionality&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="TestEditorViews.setUp">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestEditorViews.setUp">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up test data for editor view tests&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
        
        <span class="c1"># Create users</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editor</span> <span class="o">=</span> <span class="n">UserFactory</span><span class="o">.</span><span class="n">create_editor</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_editor&quot;</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="s2">&quot;editor@test.com&quot;</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journalist</span> <span class="o">=</span> <span class="n">UserFactory</span><span class="o">.</span><span class="n">create_journalist</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_journalist&quot;</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="s2">&quot;journalist@test.com&quot;</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">another_journalist</span> <span class="o">=</span> <span class="n">UserFactory</span><span class="o">.</span><span class="n">create_journalist</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;another_journalist&quot;</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="s2">&quot;another_journalist@test.com&quot;</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span>
        <span class="p">)</span>
        
        <span class="c1"># Create publisher and assign editor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span> <span class="o">=</span> <span class="n">PublisherFactory</span><span class="o">.</span><span class="n">create_publisher</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Test Publisher for Editor&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">editors</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">editor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        
        <span class="c1"># Create an article by journalist for testing approval</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span> <span class="o">=</span> <span class="n">ArticleFactory</span><span class="o">.</span><span class="n">create_article</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Article for Approval&quot;</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="s2">&quot;This article needs editor approval&quot;</span><span class="p">,</span>
            <span class="n">author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="p">,</span>
            <span class="n">category</span><span class="o">=</span><span class="n">ArticleCategory</span><span class="o">.</span><span class="n">CURRENT_EVENTS</span>
        <span class="p">)</span></div>

        
<div class="viewcode-block" id="TestEditorViews.test_editor_can_assign_journalist_to_publisher">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestEditorViews.test_editor_can_assign_journalist_to_publisher">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_editor_can_assign_journalist_to_publisher</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that an editor can assign a journalist to a publisher&quot;&quot;&quot;</span>
        
        <span class="c1"># Log in as editor</span>
        <span class="n">login_successful</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_editor&quot;</span><span class="p">,</span>
            <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">login_successful</span><span class="p">)</span>
        
        <span class="c1"># Verify journalist is not initially assigned to publisher</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotIn</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">journalists</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="p">)</span>
        
        <span class="c1"># Prepare assignment data</span>
        <span class="n">assignment_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;journalist_choice&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="c1"># Submit POST request to assign journalist</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;editor_journalist_assign_page&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">pk</span><span class="p">]),</span>
            <span class="n">data</span><span class="o">=</span><span class="n">assignment_data</span><span class="p">,</span>
            <span class="n">follow</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        
        <span class="c1"># Refresh publisher from database</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">refresh_from_db</span><span class="p">()</span>
        
        <span class="c1"># Check that journalist was assigned to publisher</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">journalists</span><span class="o">.</span><span class="n">all</span><span class="p">())</span>
        
        <span class="c1"># Check that response redirects to journalist management page</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span>
            <span class="n">response</span><span class="p">,</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;editor_journalist_management_page&#39;</span><span class="p">,</span>
                    <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">pk</span><span class="p">])</span>
        <span class="p">)</span></div>

        
<div class="viewcode-block" id="TestEditorViews.test_editor_can_approve_article_publication_status">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestEditorViews.test_editor_can_approve_article_publication_status">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_editor_can_approve_article_publication_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that an editor can approve/change article publication status&quot;&quot;&quot;</span>
        
        <span class="c1"># Log in as editor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_editor&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># Assign article to the publisher via content type</span>
        <span class="n">publisher_content_type</span> <span class="o">=</span> <span class="n">ContentType</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_for_model</span><span class="p">(</span><span class="n">Publisher</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">publisher_content_type</span> <span class="o">=</span> <span class="n">publisher_content_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">publisher_object_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">pk</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">publication_status</span> <span class="o">=</span> <span class="n">ArticleStatus</span><span class="o">.</span><span class="n">DRAFT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        
        <span class="c1"># Verify article is initially in DRAFT status</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">publication_status</span><span class="p">,</span>
            <span class="n">ArticleStatus</span><span class="o">.</span><span class="n">DRAFT</span>
        <span class="p">)</span>
        
        <span class="c1"># Prepare data to approve article (publish it)</span>
        <span class="n">approval_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
            <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">content</span><span class="p">,</span>
            <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">category</span><span class="p">,</span>
            <span class="s1">&#39;publication_status&#39;</span><span class="p">:</span> <span class="n">ArticleStatus</span><span class="o">.</span><span class="n">PUBLISHED</span><span class="p">,</span>
        <span class="p">}</span>
        
        <span class="c1"># Submit POST request to edit/approve article</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;editor_article_edit_page&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">pk</span><span class="p">]),</span>
            <span class="n">data</span><span class="o">=</span><span class="n">approval_data</span><span class="p">,</span>
            <span class="n">follow</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        
        <span class="c1"># Refresh article from database</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">refresh_from_db</span><span class="p">()</span>
        
        <span class="c1"># Check that article status was changed to PUBLISHED</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">publication_status</span><span class="p">,</span>
            <span class="n">ArticleStatus</span><span class="o">.</span><span class="n">PUBLISHED</span>
        <span class="p">)</span>
        
        <span class="c1"># Check that response redirects to article detail page</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span>
            <span class="n">response</span><span class="p">,</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;editor_article_detail_page&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">pk</span><span class="p">])</span>
        <span class="p">)</span></div>

        
<div class="viewcode-block" id="TestEditorViews.test_editor_assign_journalist_view_requires_authentication">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestEditorViews.test_editor_assign_journalist_view_requires_authentication">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_editor_assign_journalist_view_requires_authentication</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that assign journalist view requires authentication&quot;&quot;&quot;</span>
        
        <span class="c1"># Try to access assign journalist view without logging in</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;editor_journalist_assign_page&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">pk</span><span class="p">])</span>
        <span class="p">)</span>
        
        <span class="c1"># Should redirect to login page</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">302</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="TestEditorViews.test_editor_assign_journalist_view_get_request">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestEditorViews.test_editor_assign_journalist_view_get_request">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_editor_assign_journalist_view_get_request</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test GET request to assign journalist view returns form&quot;&quot;&quot;</span>
        
        <span class="c1"># Log in as editor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_editor&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># GET request to assign journalist view</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;editor_journalist_assign_page&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">pk</span><span class="p">])</span>
        <span class="p">)</span>
        
        <span class="c1"># Check response</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;form&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s1">&#39;journalist_choice&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s1">&#39;publisher&#39;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;publisher&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="TestEditorViews.test_editor_can_only_assign_to_their_publishers">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestEditorViews.test_editor_can_only_assign_to_their_publishers">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_editor_can_only_assign_to_their_publishers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that editor can only assign journalists to their publishers&quot;&quot;&quot;</span>
        
        <span class="c1"># Create another publisher not assigned to this editor</span>
        <span class="n">other_publisher</span> <span class="o">=</span> <span class="n">PublisherFactory</span><span class="o">.</span><span class="n">create_publisher</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Other Publisher&quot;</span>
        <span class="p">)</span>
        
        <span class="c1"># Log in as editor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_editor&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># Try to access assign journalist view for other publisher</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;editor_journalist_assign_page&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">other_publisher</span><span class="o">.</span><span class="n">pk</span><span class="p">])</span>
        <span class="p">)</span>
        
        <span class="c1"># Should return 404 (not found) since editor not assigned</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">404</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="TestEditorViews.test_editor_assign_multiple_journalists">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestEditorViews.test_editor_assign_multiple_journalists">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_editor_assign_multiple_journalists</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that an editor can assign multiple journalists to publisher&quot;&quot;&quot;</span>
        
        <span class="c1"># Log in as editor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_editor&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># Assign first journalist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;editor_journalist_assign_page&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">pk</span><span class="p">]),</span>
            <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;journalist_choice&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="o">.</span><span class="n">id</span><span class="p">)}</span>
        <span class="p">)</span>
        
        <span class="c1"># Assign second journalist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;editor_journalist_assign_page&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">pk</span><span class="p">]),</span>
            <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;journalist_choice&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">another_journalist</span><span class="o">.</span><span class="n">id</span><span class="p">)}</span>
        <span class="p">)</span>
        
        <span class="c1"># Refresh publisher from database</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">refresh_from_db</span><span class="p">()</span>
        
        <span class="c1"># Check that both journalists are assigned</span>
        <span class="n">assigned_journalists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">journalists</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="p">,</span> <span class="n">assigned_journalists</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">another_journalist</span><span class="p">,</span> <span class="n">assigned_journalists</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">assigned_journalists</span><span class="o">.</span><span class="n">count</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="TestEditorViews.test_editor_article_management_view_shows_publisher_articles">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestEditorViews.test_editor_article_management_view_shows_publisher_articles">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_editor_article_management_view_shows_publisher_articles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that editor article management shows only publisher articles&quot;&quot;&quot;</span>
        
        <span class="c1"># Log in as editor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_editor&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># Assign article to publisher</span>
        <span class="n">publisher_content_type</span> <span class="o">=</span> <span class="n">ContentType</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_for_model</span><span class="p">(</span><span class="n">Publisher</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">publisher_content_type</span> <span class="o">=</span> <span class="n">publisher_content_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">publisher_object_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">pk</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        
        <span class="c1"># Create another article not assigned to this publisher</span>
        <span class="n">other_article</span> <span class="o">=</span> <span class="n">ArticleFactory</span><span class="o">.</span><span class="n">create_article</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Other Article&quot;</span><span class="p">,</span>
            <span class="n">author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">another_journalist</span>
        <span class="p">)</span>
        
        <span class="c1"># GET request to article management view</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;editor_article_management_page&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">pk</span><span class="p">])</span>
        <span class="p">)</span>
        
        <span class="c1"># Check response</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">other_article</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s1">&#39;articles&#39;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s1">&#39;publisher&#39;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;publisher&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="TestEditorViews.test_editor_can_reject_article">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestEditorViews.test_editor_can_reject_article">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_editor_can_reject_article</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that an editor can reject an article&quot;&quot;&quot;</span>
        
        <span class="c1"># Log in as editor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_editor&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># Assign article to publisher</span>
        <span class="n">publisher_content_type</span> <span class="o">=</span> <span class="n">ContentType</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_for_model</span><span class="p">(</span><span class="n">Publisher</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">publisher_content_type</span> <span class="o">=</span> <span class="n">publisher_content_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">publisher_object_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">pk</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">publication_status</span> <span class="o">=</span> <span class="n">ArticleStatus</span><span class="o">.</span><span class="n">AWAITING_APPROVAL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        
        <span class="c1"># Prepare data to reject article</span>
        <span class="n">rejection_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
            <span class="s1">&#39;content&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">content</span><span class="p">,</span>
            <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">category</span><span class="p">,</span>
            <span class="s1">&#39;publication_status&#39;</span><span class="p">:</span> <span class="n">ArticleStatus</span><span class="o">.</span><span class="n">REJECTED</span><span class="p">,</span>
        <span class="p">}</span>
        
        <span class="c1"># Submit POST request to edit/reject article</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;editor_article_edit_page&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">pk</span><span class="p">]),</span>
            <span class="n">data</span><span class="o">=</span><span class="n">rejection_data</span><span class="p">,</span>
            <span class="n">follow</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        
        <span class="c1"># Refresh article from database</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">refresh_from_db</span><span class="p">()</span>
        
        <span class="c1"># Check that article status was changed to REJECTED</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">test_article</span><span class="o">.</span><span class="n">publication_status</span><span class="p">,</span>
            <span class="n">ArticleStatus</span><span class="o">.</span><span class="n">REJECTED</span>
        <span class="p">)</span></div>
</div>



<div class="viewcode-block" id="TestReaderViews">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestReaderViews">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TestReaderViews</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test all reader-related views and functionality&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="TestReaderViews.setUp">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestReaderViews.setUp">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up test data for reader view tests&quot;&quot;&quot;</span>
        <span class="c1"># Create test users</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="n">UserFactory</span><span class="o">.</span><span class="n">create_reader</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_reader&quot;</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="s2">&quot;reader@test.com&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journalist</span> <span class="o">=</span> <span class="n">UserFactory</span><span class="o">.</span><span class="n">create_journalist</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_journalist&quot;</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="s2">&quot;journalist@test.com&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">editor</span> <span class="o">=</span> <span class="n">UserFactory</span><span class="o">.</span><span class="n">create_editor</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_editor&quot;</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="s2">&quot;editor@test.com&quot;</span>
        <span class="p">)</span>
        
        <span class="c1"># Create test publisher</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span> <span class="o">=</span> <span class="n">PublisherFactory</span><span class="o">.</span><span class="n">create_publisher</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Test News Publisher&quot;</span>
        <span class="p">)</span>
        
        <span class="c1"># Create test articles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">article1</span> <span class="o">=</span> <span class="n">ArticleFactory</span><span class="o">.</span><span class="n">create_article</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Test Article 1&quot;</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="s2">&quot;Content for test article 1&quot;</span><span class="p">,</span>
            <span class="n">author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="p">,</span>
            <span class="n">publisher</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">publisher</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">article2</span> <span class="o">=</span> <span class="n">ArticleFactory</span><span class="o">.</span><span class="n">create_article</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Breaking News&quot;</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="s2">&quot;Content for breaking news&quot;</span><span class="p">,</span>
            <span class="n">author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="p">,</span>
            <span class="n">publisher</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">publisher</span>
        <span class="p">)</span>
        
        <span class="c1"># Create self-published article</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">self_published_article</span> <span class="o">=</span> <span class="n">ArticleFactory</span><span class="o">.</span><span class="n">create_article</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Self Published Article&quot;</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="s2">&quot;Content for self published article&quot;</span><span class="p">,</span>
            <span class="n">author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="p">,</span>
            <span class="n">publisher</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">journalist</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">self_published_article</span><span class="o">.</span><span class="n">publication_status</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">ArticleStatus</span><span class="o">.</span><span class="n">PUBLISHED</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">self_published_article</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span></div>

    
<div class="viewcode-block" id="TestReaderViews.test_reader_start_view_authenticated">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestReaderViews.test_reader_start_view_authenticated">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_reader_start_view_authenticated</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that authenticated readers can access the start view&quot;&quot;&quot;</span>
        <span class="c1"># Log in as reader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_reader&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># GET request to reader start view</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_start_page&#39;</span><span class="p">))</span>
        
        <span class="c1"># Check response</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s2">&quot;Search articles by title...&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s2">&quot;Welcome to News Addiction! - &quot;</span>
                            <span class="s2">&quot;All the Latest News at Your Fingertips&quot;</span>
                    <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s1">&#39;articles&#39;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;articles&#39;</span><span class="p">]),</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># All articles</span></div>

    
<div class="viewcode-block" id="TestReaderViews.test_reader_start_view_unauthenticated">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestReaderViews.test_reader_start_view_unauthenticated">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_reader_start_view_unauthenticated</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that unauthenticated users cannot access reader start view&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_start_page&#39;</span><span class="p">))</span>
        
        <span class="c1"># Should redirect to login</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">302</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s1">&#39;/login/&#39;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">url</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="TestReaderViews.test_reader_start_view_search_functionality">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestReaderViews.test_reader_start_view_search_functionality">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_reader_start_view_search_functionality</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test search functionality in reader start view&quot;&quot;&quot;</span>
        <span class="c1"># Log in as reader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_reader&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># Search for &quot;Breaking&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_start_page&#39;</span><span class="p">),</span>
            <span class="p">{</span><span class="s1">&#39;search&#39;</span><span class="p">:</span> <span class="s1">&#39;Breaking&#39;</span><span class="p">}</span>
        <span class="p">)</span>
        
        <span class="c1"># Check response</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s2">&quot;Welcome to News Addiction!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNotContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s2">&quot;Test Article 1&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;articles&#39;</span><span class="p">]),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;search_query&#39;</span><span class="p">],</span> <span class="s1">&#39;Breaking&#39;</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="TestReaderViews.test_reader_start_view_empty_search">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestReaderViews.test_reader_start_view_empty_search">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_reader_start_view_empty_search</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test search with empty query returns all articles&quot;&quot;&quot;</span>
        <span class="c1"># Log in as reader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_reader&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># Search with empty string</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_start_page&#39;</span><span class="p">),</span>
            <span class="p">{</span><span class="s1">&#39;search&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">}</span>
        <span class="p">)</span>
        
        <span class="c1"># Check response</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;articles&#39;</span><span class="p">]),</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># All articles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;search_query&#39;</span><span class="p">],</span> <span class="s1">&#39;&#39;</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="TestReaderViews.test_reader_view_article">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestReaderViews.test_reader_view_article">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_reader_view_article</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that readers can view individual articles&quot;&quot;&quot;</span>
        <span class="c1"># Log in as reader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_reader&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># GET request to view specific article</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_view_article_page&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="o">.</span><span class="n">id</span><span class="p">])</span>
        <span class="p">)</span>
        
        <span class="c1"># Check response</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;article&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;page_title&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="o">.</span><span class="n">title</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="TestReaderViews.test_reader_view_journalist_details">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestReaderViews.test_reader_view_journalist_details">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_reader_view_journalist_details</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that readers can view journalist details&quot;&quot;&quot;</span>
        <span class="c1"># Log in as reader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_reader&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># GET request to view journalist details</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_view_journalist_details_page&#39;</span><span class="p">,</span> 
                   <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="o">.</span><span class="n">id</span><span class="p">])</span>
        <span class="p">)</span>
        
        <span class="c1"># Check response</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="o">.</span><span class="n">display_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;journalist&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;previous_article_id&#39;</span><span class="p">],</span> 
                         <span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="c1"># Not subscribed initially:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;reader_subscribed&#39;</span><span class="p">])</span></div>

    
<div class="viewcode-block" id="TestReaderViews.test_reader_view_journalist_details_when_subscribed">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestReaderViews.test_reader_view_journalist_details_when_subscribed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_reader_view_journalist_details_when_subscribed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test journalist details view when reader is subscribed&quot;&quot;&quot;</span>
        <span class="c1"># Subscribe reader to journalist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="o">.</span><span class="n">journalist_profile</span><span class="o">.</span><span class="n">subscribers</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="p">)</span>
        
        <span class="c1"># Log in as reader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_reader&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># GET request to view journalist details</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_view_journalist_details_page&#39;</span><span class="p">,</span> 
                   <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="o">.</span><span class="n">id</span><span class="p">])</span>
        <span class="p">)</span>
        
        <span class="c1"># Check response</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;reader_subscribed&#39;</span><span class="p">])</span></div>

    
<div class="viewcode-block" id="TestReaderViews.test_reader_view_publisher_details_regular_article">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestReaderViews.test_reader_view_publisher_details_regular_article">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_reader_view_publisher_details_regular_article</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that readers can view publisher details for regular articles&quot;&quot;&quot;</span>
        <span class="c1"># Log in as reader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_reader&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># Set up content type for publisher</span>
        <span class="n">publisher_content_type</span> <span class="o">=</span> <span class="n">ContentType</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get_for_model</span><span class="p">(</span><span class="n">Publisher</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="o">.</span><span class="n">publisher_content_type</span> <span class="o">=</span> <span class="n">publisher_content_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="o">.</span><span class="n">publisher_object_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        
        <span class="c1"># GET request to view publisher details</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_view_publisher_details_page&#39;</span><span class="p">,</span> 
                   <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="o">.</span><span class="n">id</span><span class="p">])</span>
        <span class="p">)</span>
        
        <span class="c1"># Check response</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertContains</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;publisher&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;article&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="p">)</span>
        <span class="c1"># Not subscribed initially:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">context</span><span class="p">[</span><span class="s1">&#39;reader_subscribed&#39;</span><span class="p">])</span>  </div>

    
<div class="viewcode-block" id="TestReaderViews.test_reader_view_publisher_details_self_published_redirects">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestReaderViews.test_reader_view_publisher_details_self_published_redirects">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_reader_view_publisher_details_self_published_redirects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that self-published articles redirect to journalist details&quot;&quot;&quot;</span>
        <span class="c1"># Log in as reader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_reader&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># GET request to view publisher details for self-published article</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_view_publisher_details_page&#39;</span><span class="p">,</span> 
                   <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">self_published_article</span><span class="o">.</span><span class="n">id</span><span class="p">])</span>
        <span class="p">)</span>
        
        <span class="c1"># Should redirect to journalist details</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">302</span><span class="p">)</span>
        <span class="n">expected_url</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_view_journalist_details_page&#39;</span><span class="p">,</span>
                             <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">self_published_article</span><span class="o">.</span><span class="n">id</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">expected_url</span><span class="p">)</span></div>

    
<div class="viewcode-block" id="TestReaderViews.test_reader_journalist_subscribe">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestReaderViews.test_reader_journalist_subscribe">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_reader_journalist_subscribe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that readers can subscribe to journalists&quot;&quot;&quot;</span>
        <span class="c1"># Log in as reader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_reader&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># Ensure reader is not subscribed initially</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="o">.</span><span class="n">journalist_profile</span><span class="o">.</span><span class="n">subscribers</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">id</span>
            <span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
        <span class="p">)</span>
        
        <span class="c1"># POST request to subscribe</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_journalist_subscribe_unsubscribe_page&#39;</span><span class="p">,</span>
                   <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="o">.</span><span class="n">id</span><span class="p">])</span>
        <span class="p">)</span>
        
        <span class="c1"># Should redirect back to journalist details</span>
        <span class="n">expected_url</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_view_journalist_details_page&#39;</span><span class="p">,</span>
                             <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="o">.</span><span class="n">id</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">expected_url</span><span class="p">)</span>
        
        <span class="c1"># Check that reader is now subscribed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="o">.</span><span class="n">journalist_profile</span><span class="o">.</span><span class="n">subscribers</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">id</span>
            <span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
        <span class="p">)</span></div>

    
<div class="viewcode-block" id="TestReaderViews.test_reader_journalist_unsubscribe">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestReaderViews.test_reader_journalist_unsubscribe">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_reader_journalist_unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that readers can unsubscribe from journalists&quot;&quot;&quot;</span>
        <span class="c1"># Subscribe reader to journalist first</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="o">.</span><span class="n">journalist_profile</span><span class="o">.</span><span class="n">subscribers</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="p">)</span>
        
        <span class="c1"># Log in as reader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_reader&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># Ensure reader is subscribed initially</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="o">.</span><span class="n">journalist_profile</span><span class="o">.</span><span class="n">subscribers</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">id</span>
            <span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
        <span class="p">)</span>
        
        <span class="c1"># POST request to unsubscribe</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_journalist_subscribe_unsubscribe_page&#39;</span><span class="p">,</span>
                   <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="o">.</span><span class="n">id</span><span class="p">])</span>
        <span class="p">)</span>
        
        <span class="c1"># Should redirect back to journalist details</span>
        <span class="n">expected_url</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_view_journalist_details_page&#39;</span><span class="p">,</span>
                             <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="o">.</span><span class="n">id</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">expected_url</span><span class="p">)</span>
        
        <span class="c1"># Check that reader is no longer subscribed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">journalist</span><span class="o">.</span><span class="n">journalist_profile</span><span class="o">.</span><span class="n">subscribers</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">id</span>
            <span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
        <span class="p">)</span></div>

    
<div class="viewcode-block" id="TestReaderViews.test_reader_publisher_subscribe">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestReaderViews.test_reader_publisher_subscribe">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_reader_publisher_subscribe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that readers can subscribe to publishers&quot;&quot;&quot;</span>
        <span class="c1"># Log in as reader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_reader&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># Ensure reader is not subscribed initially</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">subscribers</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
        <span class="p">)</span>
        
        <span class="c1"># POST request to subscribe</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_publisher_subscribe_unsubscribe_page&#39;</span><span class="p">,</span>
                   <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="o">.</span><span class="n">id</span><span class="p">])</span>
        <span class="p">)</span>
        
        <span class="c1"># Should redirect back to publisher details</span>
        <span class="n">expected_url</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_view_publisher_details_page&#39;</span><span class="p">,</span>
                             <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="o">.</span><span class="n">id</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">expected_url</span><span class="p">)</span>
        
        <span class="c1"># Check that reader is now subscribed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">subscribers</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
        <span class="p">)</span></div>

    
<div class="viewcode-block" id="TestReaderViews.test_reader_publisher_unsubscribe">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestReaderViews.test_reader_publisher_unsubscribe">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_reader_publisher_unsubscribe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that readers can unsubscribe from publishers&quot;&quot;&quot;</span>
        <span class="c1"># Subscribe reader to publisher first</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">subscribers</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="p">)</span>
        
        <span class="c1"># Log in as reader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_reader&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># Ensure reader is subscribed initially</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">subscribers</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
        <span class="p">)</span>
        
        <span class="c1"># POST request to unsubscribe</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_publisher_subscribe_unsubscribe_page&#39;</span><span class="p">,</span>
                   <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="o">.</span><span class="n">id</span><span class="p">])</span>
        <span class="p">)</span>
        
        <span class="c1"># Should redirect back to publisher details</span>
        <span class="n">expected_url</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_view_publisher_details_page&#39;</span><span class="p">,</span>
                             <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="o">.</span><span class="n">id</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertRedirects</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">expected_url</span><span class="p">)</span>
        
        <span class="c1"># Check that reader is no longer subscribed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertFalse</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">publisher</span><span class="o">.</span><span class="n">subscribers</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span>
        <span class="p">)</span></div>

    
<div class="viewcode-block" id="TestReaderViews.test_non_reader_cannot_access_reader_views">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.TestReaderViews.test_non_reader_cannot_access_reader_views">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_non_reader_cannot_access_reader_views</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test that non-readers cannot access reader-specific views&quot;&quot;&quot;</span>
        <span class="c1"># Log in as journalist (not a reader)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_journalist&quot;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&quot;testpass123&quot;</span><span class="p">)</span>
        
        <span class="c1"># Try to access reader start view</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_start_page&#39;</span><span class="p">))</span>
        
        <span class="c1"># Should redirect (user_passes_test decorator)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">302</span><span class="p">)</span>
        
        <span class="c1"># Try to access reader article view</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;reader_view_article_page&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">article1</span><span class="o">.</span><span class="n">id</span><span class="p">])</span>
        <span class="p">)</span>
        
        <span class="c1"># Should redirect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">302</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="APIGetArticlesTestCase">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.APIGetArticlesTestCase">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">APIGetArticlesTestCase</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test cases for the API_get_articles view&quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="APIGetArticlesTestCase.setUp">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.APIGetArticlesTestCase.setUp">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">setUp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up test data&quot;&quot;&quot;</span>
        <span class="c1"># Create test users</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journalist1</span> <span class="o">=</span> <span class="n">UserFactory</span><span class="o">.</span><span class="n">create_journalist</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_journalist_1&quot;</span><span class="p">,</span>
            <span class="n">email</span><span class="o">=</span><span class="s2">&quot;journalist1@test.com&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">journalist2</span> <span class="o">=</span> <span class="n">UserFactory</span><span class="o">.</span><span class="n">create_journalist</span><span class="p">(</span>
            <span class="n">username</span><span class="o">=</span><span class="s2">&quot;test_journalist_2&quot;</span><span class="p">,</span> 
            <span class="n">email</span><span class="o">=</span><span class="s2">&quot;journalist2@test.com&quot;</span>
        <span class="p">)</span>
        
        <span class="c1"># Create test publishers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publisher1</span> <span class="o">=</span> <span class="n">PublisherFactory</span><span class="o">.</span><span class="n">create_publisher</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Test Publisher 1&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;First test publisher&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">publisher2</span> <span class="o">=</span> <span class="n">PublisherFactory</span><span class="o">.</span><span class="n">create_publisher</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Test Publisher 2&quot;</span><span class="p">,</span> 
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Second test publisher&quot;</span>
        <span class="p">)</span>
        
        <span class="c1"># Create test articles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">article1</span> <span class="o">=</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Article by Journalist 1&quot;</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="s2">&quot;Content of article by journalist 1&quot;</span><span class="p">,</span>
            <span class="n">author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">journalist1</span><span class="p">,</span>
            <span class="n">publisher</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">publisher1</span><span class="p">,</span>
            <span class="n">category</span><span class="o">=</span><span class="n">ArticleCategory</span><span class="o">.</span><span class="n">POLITICS</span><span class="p">,</span>
            <span class="n">publication_status</span><span class="o">=</span><span class="n">ArticleStatus</span><span class="o">.</span><span class="n">PUBLISHED</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">article2</span> <span class="o">=</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Another Article by Journalist 1&quot;</span><span class="p">,</span> 
            <span class="n">content</span><span class="o">=</span><span class="s2">&quot;More content by journalist 1&quot;</span><span class="p">,</span>
            <span class="n">author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">journalist1</span><span class="p">,</span>
            <span class="n">publisher</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">publisher2</span><span class="p">,</span>
            <span class="n">category</span><span class="o">=</span><span class="n">ArticleCategory</span><span class="o">.</span><span class="n">SPORTS</span><span class="p">,</span>
            <span class="n">publication_status</span><span class="o">=</span><span class="n">ArticleStatus</span><span class="o">.</span><span class="n">PUBLISHED</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">article3</span> <span class="o">=</span> <span class="n">Article</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Article by Journalist 2&quot;</span><span class="p">,</span>
            <span class="n">content</span><span class="o">=</span><span class="s2">&quot;Content by journalist 2&quot;</span><span class="p">,</span>
            <span class="n">author</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">journalist2</span><span class="p">,</span>
            <span class="n">publisher</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">publisher1</span><span class="p">,</span>
            <span class="n">category</span><span class="o">=</span><span class="n">ArticleCategory</span><span class="o">.</span><span class="n">TECHNOLOGY</span><span class="p">,</span>
            <span class="n">publication_status</span><span class="o">=</span><span class="n">ArticleStatus</span><span class="o">.</span><span class="n">PUBLISHED</span>
        <span class="p">)</span>
        
        <span class="c1"># Create a test user for API authentication</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">api_user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">journalist1</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span></div>

        
<div class="viewcode-block" id="APIGetArticlesTestCase.test_api_get_articles_with_specific_author">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.APIGetArticlesTestCase.test_api_get_articles_with_specific_author">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_api_get_articles_with_specific_author</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test API request to get articles by a specific author&quot;&quot;&quot;</span>
        <span class="c1"># Authenticate the request</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;test_journalist_1:testpass123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
        <span class="c1"># Make API request with specific author name</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s1">&#39;/get/articles/&#39;</span><span class="p">,</span>
            <span class="p">{</span><span class="s1">&#39;author_name&#39;</span><span class="p">:</span> <span class="s1">&#39;test_journalist_1&#39;</span><span class="p">},</span>
            <span class="n">HTTP_AUTHORIZATION</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Basic </span><span class="si">{</span><span class="n">credentials</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span>
        
        <span class="c1"># Check response status</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        
        <span class="c1"># Parse JSON response</span>
        <span class="n">response_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        
        <span class="c1"># Should return 2 articles by test_journalist_1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">response_data</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        
        <span class="c1"># Check that all returned articles are by the correct author</span>
        <span class="k">for</span> <span class="n">article_data</span> <span class="ow">in</span> <span class="n">response_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">article_data</span><span class="p">[</span><span class="s1">&#39;author_user_name&#39;</span><span class="p">],</span> <span class="s1">&#39;test_journalist_1&#39;</span><span class="p">)</span>
            
        <span class="c1"># Check specific article titles are included</span>
        <span class="n">article_titles</span> <span class="o">=</span> <span class="p">[</span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">article</span> <span class="ow">in</span> <span class="n">response_data</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s2">&quot;Article by Journalist 1&quot;</span><span class="p">,</span> <span class="n">article_titles</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertIn</span><span class="p">(</span><span class="s2">&quot;Another Article by Journalist 1&quot;</span><span class="p">,</span> <span class="n">article_titles</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="APIGetArticlesTestCase.test_api_get_articles_with_nonexistent_author">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.APIGetArticlesTestCase.test_api_get_articles_with_nonexistent_author">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_api_get_articles_with_nonexistent_author</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test API request with an author that doesn&#39;t exist&quot;&quot;&quot;</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;test_journalist_1:testpass123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
        
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s1">&#39;/get/articles/&#39;</span><span class="p">,</span>
            <span class="p">{</span><span class="s1">&#39;author_name&#39;</span><span class="p">:</span> <span class="s1">&#39;nonexistent_author&#39;</span><span class="p">},</span>
            <span class="n">HTTP_AUTHORIZATION</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Basic </span><span class="si">{</span><span class="n">credentials</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="n">response_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        
        <span class="c1"># Should return empty list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">response_data</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="APIGetArticlesTestCase.test_api_get_articles_without_authentication">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.APIGetArticlesTestCase.test_api_get_articles_without_authentication">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_api_get_articles_without_authentication</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test API request without authentication should fail&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s1">&#39;/get/articles/&#39;</span><span class="p">,</span>
            <span class="p">{</span><span class="s1">&#39;author_name&#39;</span><span class="p">:</span> <span class="s1">&#39;test_journalist_1&#39;</span><span class="p">}</span>
        <span class="p">)</span>
        
        <span class="c1"># Should return 401 Unauthorized</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">401</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="APIGetArticlesTestCase.test_api_get_articles_all_articles">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.APIGetArticlesTestCase.test_api_get_articles_all_articles">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_api_get_articles_all_articles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test API request to get all articles (no filter)&quot;&quot;&quot;</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;test_journalist_1:testpass123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
        
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s1">&#39;/get/articles/&#39;</span><span class="p">,</span>
            <span class="n">HTTP_AUTHORIZATION</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Basic </span><span class="si">{</span><span class="n">credentials</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="n">response_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        
        <span class="c1"># Should return all 3 articles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">response_data</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span></div>

        
<div class="viewcode-block" id="APIGetArticlesTestCase.test_api_get_articles_with_publisher_filter">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.APIGetArticlesTestCase.test_api_get_articles_with_publisher_filter">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_api_get_articles_with_publisher_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test API request to get articles by publisher&quot;&quot;&quot;</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;test_journalist_1:testpass123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
        
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s1">&#39;/get/articles/&#39;</span><span class="p">,</span>
            <span class="p">{</span><span class="s1">&#39;publisher_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test Publisher 1&#39;</span><span class="p">},</span>
            <span class="n">HTTP_AUTHORIZATION</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Basic </span><span class="si">{</span><span class="n">credentials</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="n">response_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        
        <span class="c1"># Should return 2 articles from Test Publisher 1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">response_data</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
        
        <span class="c1"># Check that all returned articles are from the correct publisher</span>
        <span class="k">for</span> <span class="n">article_data</span> <span class="ow">in</span> <span class="n">response_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">article_data</span><span class="p">[</span><span class="s1">&#39;publisher_name&#39;</span><span class="p">],</span> <span class="s1">&#39;Test Publisher 1&#39;</span><span class="p">)</span></div>

            
<div class="viewcode-block" id="APIGetArticlesTestCase.test_api_get_articles_with_both_author_and_publisher_filter">
<a class="viewcode-back" href="../../news_application.html#news_application.tests.APIGetArticlesTestCase.test_api_get_articles_with_both_author_and_publisher_filter">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">test_api_get_articles_with_both_author_and_publisher_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Test API request with both author and publisher filters&quot;&quot;&quot;</span>
        <span class="n">credentials</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;test_journalist_1:testpass123&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
        
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s1">&#39;/get/articles/&#39;</span><span class="p">,</span>
            <span class="p">{</span>
                <span class="s1">&#39;author_name&#39;</span><span class="p">:</span> <span class="s1">&#39;test_journalist_1&#39;</span><span class="p">,</span>
                <span class="s1">&#39;publisher_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test Publisher 1&#39;</span>
            <span class="p">},</span>
            <span class="n">HTTP_AUTHORIZATION</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Basic </span><span class="si">{</span><span class="n">credentials</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
        <span class="n">response_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
        
        <span class="c1"># Should return 1 article (journalist 1 + publisher 1)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">response_data</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="n">article_data</span> <span class="o">=</span> <span class="n">response_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">article_data</span><span class="p">[</span><span class="s1">&#39;author_user_name&#39;</span><span class="p">],</span> <span class="s1">&#39;test_journalist_1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">article_data</span><span class="p">[</span><span class="s1">&#39;publisher_name&#39;</span><span class="p">],</span> <span class="s1">&#39;Test Publisher 1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">article_data</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">],</span> <span class="s1">&#39;Article by Journalist 1&#39;</span><span class="p">)</span></div>
</div>


</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Jacques Blignaut.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>